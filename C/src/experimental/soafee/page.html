<!DOCTYPE html>
<html>
  <head><title>Browser UI for Lingua Franca</title>
    <style>
        #dashboard {
            width: 500px;
            height: 200px;
            background-color:antiquewhite;
            position: relative;
        }
        #car {
            width: 300px;
            height: 200px;
            position: relative;
            top: 40px;
            left: 100px;
            overflow: hidden;
        }
        #front {
            width: 10px;
            height: 120px;
            top: 40px;
            float: left;
            background-color: blue;
            position: relative;
        }
    </style>
  </head>
  <body>
    <h1>Dashboard Display</h1>
    <p><button id="start">start</button></p>
    <div id="dashboard">
        <div id="front"></div>
        <div id="car">
            <svg width="300" height="120">
                <rect fill="cadetblue" x="0" y="0" width="300" height="120" rx="15"/>
                <rect fill="cadetblue" stroke="aliceblue" x="100" y="15" width="120" height="90"/>
                <polygon fill="aliceblue" points="70,0 100,15 100,105 70,120"/>
                <polygon fill="aliceblue" points="220,15 240,0 240,120 220,105"/>
            <svg>
        </div>
    </div>
    <p id="message"></p>
    <script>
  document.getElementById('start').addEventListener('click', function() {
    setInterval(function() {
        var xhttp = new XMLHttpRequest();
        xhttp.onload = function() {
          if (this.status == 200) {
            document.getElementById('message').innerHTML = "Sensor data: " + this.responseText;
            
            var data = JSON.parse(this.responseText);
            const front = document.getElementById('front');
            console.log("Distance: " + data.front_distance);
            var position = 100 - data.front_distance;
            if (position >= 100) {
                front.style.backgroundColor = "fuchsia";
                position = 100;
            } else if (position > 50) {
                front.style.backgroundColor = "red";
            } else if (position > 0) {
                front.style.backgroundColor = "gold";
            } else {
                front.style.backgroundColor = "blue";
                position = 0;
            }
            front.style.left = position + 'px';
          } else {
            document.getElementById('message').innerHTML = "Error: " + this.statusText;
          }
        };
        xhttp.open('GET', '/count', true);
        xhttp.send(null);
    }, 500);
  }); 
    </script>
  </body>
</html>
